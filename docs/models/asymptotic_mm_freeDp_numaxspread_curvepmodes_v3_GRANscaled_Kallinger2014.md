# asymptotic_mm_freeDp_numaxspread_curvepmodes_v3_GRANscaled_Kallinger2014

## What this model is for

This model generates mixed modes for evolved stars using the asymptotic mixed-mode solver (ARMM). It supports a Kallinger+2014 granulation noise background and requires template files for height/width profiles.

## Required inputs

- `main.cfg` with the model name and parameter block.
- `template_files` must reference one or more `*.template` files (often `all`).
- `noise_Kallinger2014.cfg` is required (passed via `--noise_file` or resolved from `Configurations/`).
- Forest support: `random` only.

Optional mixed-mode override file:

- If you want to supply theoretical frequencies, copy `Configurations/MixedModes_models/star_params.theoretical.EXAMPLE` to `Configurations/MixedModes_models/star_params.theoretical`.

Example config: `Configurations/examples_cfg/main.cfg.freeDP_curvepmodes.v3_GRANscaled`

## Parameter order (registry)

Noise parameters are appended automatically from `noise_Kallinger2014.cfg` and are not listed in the main cfg labels line.

| # | Label | Meaning / notes |
|---|-------|-----------------|
| 1 | nurot_env | Envelope rotation frequency. |
| 2 | nurot_core | Core rotation frequency. |
| 3 | a2_l1_core | Currently unused; keep at 0. |
| 4 | a2_l1_env | Currently unused; keep at 0. |
| 5 | a2_l2_env | Asphericity coefficient for l=2 envelope. |
| 6 | a2_l3_env | Asphericity coefficient for l=3 envelope (set to <= -9999 to match a2_l2_env). |
| 7 | a3_l2_env | Latitudinal rotation coefficient for l=2. |
| 8 | a3_l3_env | Latitudinal rotation coefficient for l=3 (set to <= -9999 to match a3_l2_env). |
| 9 | a4_l2_env | Asphericity coefficient for l=2. |
| 10 | a4_l3_env | Asphericity coefficient for l=3 (set to <= -9999 to match a4_l2_env). |
| 11 | a5_l3_env | Higher-order coefficient for l=3. |
| 12 | a6_l3_env | Higher-order coefficient for l=3. |
| 13 | Dnu | Large separation (uHz). |
| 14 | epsilon | Asymptotic phase term. |
| 15 | delta0l_percent | Small separation in percent (input magnitude; internal sign is negative). |
| 16 | beta_p_star | P-mode coupling parameter. |
| 17 | nmax_spread | Spread on radial order around `numax`. |
| 18 | DP1 | Dipole period spacing (seconds). |
| 19 | alpha | Mixed-mode asymptotic parameter. |
| 20 | q | Coupling factor. |
| 21 | SNR | Target max height-to-noise ratio for l=0. |
| 22 | maxGamma | Target max width for l=0. |
| 23 | numax_spread | Percent spread applied to `numax`. |
| 24 | Vl1 | Visibility factor for l=1. |
| 25 | Vl2 | Visibility factor for l=2. |
| 26 | Vl3 | Visibility factor for l=3. |
| 27 | H0_spread | Percent height jitter. |
| 28 | k_Agran | Kallinger noise parameter (from noise cfg). |
| 29 | s_Agran | Kallinger noise parameter (from noise cfg). |
| 30 | k_taugran | Kallinger noise parameter (from noise cfg). |
| 31 | s_taugran | Kallinger noise parameter (from noise cfg). |
| 32 | c0 | Kallinger noise parameter (from noise cfg). |
| 33 | ka | Kallinger noise parameter (from noise cfg). |
| 34 | ks | Kallinger noise parameter (from noise cfg). |
| 35 | k1 | Kallinger noise parameter (from noise cfg). |
| 36 | s1 | Kallinger noise parameter (from noise cfg). |
| 37 | c1 | Kallinger noise parameter (from noise cfg). |
| 38 | k2 | Kallinger noise parameter (from noise cfg). |
| 39 | s2 | Kallinger noise parameter (from noise cfg). |
| 40 | c2 | Kallinger noise parameter (from noise cfg). |
| 41 | N0 | White noise level (from noise cfg). |
| 42 | Hfactor | Height scale factor. |
| 43 | Wfactor | Width scale factor. |

Note: `Tobs` and `Cadence` are appended internally for noise conversion and are not part of the main cfg labels.

## Physics assumptions and equations

- Mixed modes are generated by the ARMM solver based on asymptotic parameters (`Dnu`, `epsilon`, `DP1`, `q`, `alpha`).
- `numax` is derived from `Dnu` (Stello 2009 relation) with an optional `numax_spread`.
- Granulation noise follows Kallinger+2014 and is converted to Harvey-like terms internally.

## How to run

```bash
./build/specsim \
  --main_file main.cfg.freeDP_curvepmodes.v3_GRANscaled \
  --main_dir Configurations/examples_cfg \
  --noise_file noise_Kallinger2014.cfg \
  --out_dir /tmp/specsim-out \
  --force-create-output-dir 1
```

## Outputs

- `Combinations.txt`
- `Spectra_ascii/`, `Spectra_info/`, optional `Spectra_modelfile/`, `Spectra_plot/`
- `Spectra_info/<id>.global` (mixed-mode config snapshot, when available)

## Common pitfalls and tips

- `template_files` must point to valid `.template` files; `all` is common for mixed modes.
- `a2_l1_core` and `a2_l1_env` are currently unused; keep them at 0.
- To tie l=2 and l=3 coefficients, set `a2_l3_env`, `a3_l3_env`, or `a4_l3_env` to <= -9999.
- Ensure `noise_Kallinger2014.cfg` is available and readable.
